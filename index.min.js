(function(a){function b(f,g){var e=localStorage.getItem(f),d=this,c=e?JSON.parse(e):{};Object.defineProperty(d,"_key",{value:f});Object.defineProperty(d,"_listeners",{value:[]});Object.keys(c).forEach(function(h){d._defineProperty(h,c[h])});Object.keys(g||{}).forEach(function(h){if(!d.hasOwnProperty(h)){d._defineProperty(h,g[h])}});if(!e){this._save()}if(window.addEventListener){window.addEventListener("storage",d._onStorage,false)}else{if(window.attachEvent){window.attachEvent("onstorage",d._onStorage)}}}b.prototype._defineProperty=function(c,d){Object.defineProperty(this,c,{enumerable:true,writeable:true,get:function(){return d},set:function(e){if(e===d){return}d=e;this._save();this._emit("local")}})};b.prototype._save=function(){localStorage.setItem(this._key,JSON.stringify(this))};b.prototype._subscribe=function(c){this._listeners.push(c)};b.prototype._unsubscribe=function(d){var c=this._listeners.indexOf(d);if(c<0){return}this._listeners.splice(c,1)};b.prototype._emit=function(c){this._listeners.forEach(function(d){d(c)})};b.prototype._onStorage=function(d){var e=this;if(d.key!==e._key){return}var c=JSON.parse(d);Object.keys(c).forEach(function(f){if(e.hasOwnProperty(f)){e[f]=c[f]}else{e._defineProperty(f,c[f])}});this._emit("remote")};b.prototype._destroy=function(){if(window.removeEventListener){window.removeEventListener("storage",this._onStorage,false)}else{if(window.detachEvent){window.detachEvent("onstorage",this._onStorage)}}};a.LiveObject=b})(this);